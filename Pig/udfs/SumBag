PigScript:
----------
register /home/hadoopz/naga/bigdata/pig-0.10.0/pigscripts/sumbag.jar
products = load '/pig/products' using PigStorage() as (product:chararray, price:double);
grpproducts = group products by product;
prosum = foreach grpproducts generate group, com.pig.udf.SumBag(products.price) as sum;
dump prosum;

UDF
---
package com.pig.udf;

import java.io.IOException;
import java.util.Iterator;

import org.apache.pig.EvalFunc;
import org.apache.pig.data.DataBag;
import org.apache.pig.data.Tuple;

public class SumBag extends EvalFunc<Double> {

	@Override
	public Double exec(Tuple input) throws IOException {
		if (input == null || input.size() == 0) {
			return null;
		}
		DataBag myBag = (DataBag) input.get(0);
		Iterator<Tuple> itr = myBag.iterator();
		Tuple tuple = null;
		Double sum = 0.0d;
		while (itr.hasNext()) {
			tuple = itr.next();
			Double price = (Double) tuple.get(0);
			sum = sum + price;
		}
		return Math.round(sum * 100.0) / 100.0;
	}
}
